p8150_hw2_wz2629
================
Wen Dai
2023-09-27

``` r
library (tidyverse)
library(readxl)
```

# Problem 1:

Step1 : clean the data in pols-month.csv

``` r
month_df = 
  tibble(
    month_num = 1:12,
    month_abb = month.abb,
    month = month.name
  )

polmonth_df = 
  read_csv("fivethirtyeight_datasets/pols-month.csv") |>
  separate(mon, into = c("year", "month_num", "day"), convert = TRUE) |>
  mutate(
    president = recode(prez_gop, "0" = "dem", "1" = "gop", "2" = "gop")) |>
  left_join(x = _, y = month_df) |> 
  select(year, month, everything(), -day, -starts_with("prez"))
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
    ## Joining with `by = join_by(month_num)`

Step 2: clean the data in snp.csv

``` r
snp_df = 
  read_csv(
    "fivethirtyeight_datasets/snp.csv",
    col_types = cols(date = col_date(format = "%m/%d/%y"))) |>
  separate(date, into = c("year", "month_num", "day"), convert = TRUE) |>
  mutate(
    year = if_else(year > 2023, year - 100, year)) |> 
  left_join(x = _, y = month_df) |> 
  select(year, month, close) 
```

    ## Joining with `by = join_by(month_num)`

Step 3: clean the data in unemployment.csv

``` r
  unemployment_df=read_csv("fivethirtyeight_datasets/unemployment.csv") |>
  rename(year = Year) |>
  pivot_longer(
    Jan:Dec, 
    names_to = "month_abb",
    values_to = "unemployment"
  ) |> 
  left_join(x = _, y = month_df) |> 
  select(year, month, unemployment)
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
    ## Joining with `by = join_by(month_abb)`

step 4: Join the dataset by merging snp into pols, and merging
unemployment into the result.

``` r
combine = 
  left_join(polmonth_df, snp_df) |>
  left_join(x = _, y = unemployment_df)
```

    ## Joining with `by = join_by(year, month)`
    ## Joining with `by = join_by(year, month)`

``` r
str(combine)
```

    ## tibble [822 × 13] (S3: tbl_df/tbl/data.frame)
    ##  $ year        : num [1:822] 1947 1947 1947 1947 1947 ...
    ##  $ month       : chr [1:822] "January" "February" "March" "April" ...
    ##  $ month_num   : int [1:822] 1 2 3 4 5 6 7 8 9 10 ...
    ##  $ gov_gop     : num [1:822] 23 23 23 23 23 23 23 23 23 23 ...
    ##  $ sen_gop     : num [1:822] 51 51 51 51 51 51 51 51 51 51 ...
    ##  $ rep_gop     : num [1:822] 253 253 253 253 253 253 253 253 253 253 ...
    ##  $ gov_dem     : num [1:822] 23 23 23 23 23 23 23 23 23 23 ...
    ##  $ sen_dem     : num [1:822] 45 45 45 45 45 45 45 45 45 45 ...
    ##  $ rep_dem     : num [1:822] 198 198 198 198 198 198 198 198 198 198 ...
    ##  $ president   : chr [1:822] "dem" "dem" "dem" "dem" ...
    ##  $ month_abb   : chr [1:822] "Jan" "Feb" "Mar" "Apr" ...
    ##  $ close       : num [1:822] NA NA NA NA NA NA NA NA NA NA ...
    ##  $ unemployment: num [1:822] NA NA NA NA NA NA NA NA NA NA ...

Step 5: Write a short paragraph about these data set. Explain briefly
what each dataset contained, and describe the resulting dataset.
(e.g. give the dimension, range of years and names of key variables)

Notice that there are some `NA` values in the `close` and `unemployment`
variables, which indicate that the value of these variables is missing
at those locations.

Let’s talk about the “combine_df” datasets. The `polmonth_df` data has
822 observations and 11 variables and tells us about the party
affiliation distribution (democrat or republican) for governors and
senators for a given year from years 1947 to 2015. It also tells us
whether the sitting president was a democrat or republican.

The `snp_df` data has 787 observations and 3 variables, ranging from
years 1950 to 2015.

The `unemployment_df` data has 816 observations and 3 variables ranging
from years 1948 to 2015.

In Januarys in or after 1975 in which a democrat was president, the
**average unemployment rate was 6.57**. The average unemployment rate
over the same time period in which a republican was president was 6.47.

# Problem 2:

Step 1: Tidy Mr. trashwheel’s dataset

``` r
Mr_df = read_excel("202309 Trash Wheel Collection Data.xlsx", sheet="Mr. Trash Wheel",skip=1,range="A2:N587") |> 
  janitor::clean_names() |> 
drop_na(dumpster) |> 
  mutate(
 homes_powered=weight_tons*500/30,
TrashWheel="Mr.Trash Wheel")|> 
  mutate (year=as.character(year)) |> 
  select(dumpster, month, year, date, weight=weight_tons,volume=volume_cubic_yards, bottles=plastic_bottles,polystyrene,cigarette=cigarette_butts,glass=glass_bottles,bags=plastic_bags,wrappers,sports=sports_balls,homes_powered,TrashWheel)
```

Step 2: Tidy Professor Trash Wheel

``` r
Professor_df = read_excel("202309 Trash Wheel Collection Data.xlsx", sheet="Professor Trash Wheel",skip=1,range="A2:M109") |> 
  janitor::clean_names() |> 
  drop_na(dumpster) |> 
  mutate(
 homes_powered=weight_tons*500/30,
TrashWheel="Professor Trash Wheel") |> 
  mutate (year=as.character(year)) |> 
  select(dumpster, month, year, date, weight=weight_tons, volume=volume_cubic_yards,bottles=plastic_bottles, polystyrene, cigarette=cigarette_butts,glass=glass_bottles,plastic=plastic_bags,wrappers,homes_powered,TrashWheel)
```

Step 3: Tidy Gwynnda Trash Wheel

``` r
Gwynnda_df = read_excel("202309 Trash Wheel Collection Data.xlsx", sheet="Gwynnda Trash Wheel",skip=1, range="A2:L159") |> 
  janitor::clean_names() |> 
  drop_na(dumpster) |> 
  mutate(
 homes_powered=weight_tons*500/30,
TrashWheel="Professor Trash Wheel")|> 
  mutate (year=as.character(year)) |> 
  select(dumpster, month, year, date, weight=weight_tons, volume=volume_cubic_yards,bottles=plastic_bottles, polystyrene, cigarette=cigarette_butts,plastic=plastic_bags,wrappers,homes_powered,TrashWheel)
```

Step 4: Combine these dataset with Mr. Trash Wheel datset to produce a
single tidy dataset,.

``` r
TW_df=bind_rows(Mr_df,Professor_df,Gwynnda_df)
```
